/*! Wings 0.1.0 */var Wings;!function(){window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}();var js;!function(){"use strict";js={not:function(a){return!a},notDefined:function(a){return void 0===a},typeOf:function(a){return this.isFunction(a)?a.name||Function.name:a.constructor.name||Object.name},isType:function(a,b){return a instanceof b},empty:function(a){return 0===a.length},notEmpty:function(a){return 0!==a.length},isFunction:function(a){return"function"==typeof a},run:function(a){if(js.not(js.run._waiting)&&(js.run._waiting=[]),js.isFunction(a)&&js.run._waiting.push(a),js.not(js.run._firstCalled))return window.addEventListener("load",js.run),js.run._firstCalled=!0;if(js.not(document.body))return setTimeout(js.run,1);if(js.not(js.run._running)){js.run._running=js.run._waiting,js.run._waiting=[];for(var b in js.run._running)js.run._running[b]();js.run._running=void 0,js.notEmpty(js.run._waiting)&&js.run()}}}}();var assert;!function(){assert={isTrue:function(a,b){this.isFalse(!a,b)},isFalse:function(a,b){if(a)throw new Error(b)},isType:function(a,b){js.isType(b,Array)||(b=[b]);for(var c=js.typeOf(b[0]),d=js.isType(a,b[0]),e=1;e<b.length;e++)c+=" or "+js.typeOf(b[e]),d|=js.isType(a,b[e]);this.isTrue(d,"expected "+c+", but got "+js.typeOf(a))}}}();var elem;!function(){elem={absoluteLocation:function(a){var b=a.getBoundingClientRect();return{x:b.left,y:b.top}}}}();var Class;!function(){Class=function(){};var initializing=!1,fnTest=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;Class.extend=function(prop){function construct(){!initializing&&this.init&&this.init.apply(this,arguments)}var _super=this.prototype;initializing=!0;var prototype=new this;initializing=!1;for(var name in prop)prototype[name]="function"==typeof prop[name]&&"function"==typeof _super[name]&&fnTest.test(prop[name])?function(a,b){return function(){var c=this._super;this._super=_super[a];var d=b.apply(this,arguments);return this._super=c,d}}(name,prop[name]):prop[name];var Class;return eval("Class = function "+(prop.init&&prop.init.name?prop.init.name:"Class")+"() { construct.apply(this, arguments); };"),Class.prototype=prototype,Class.prototype.constructor=Class,Class.extend=arguments.callee,Class}}();var Point,Size,Rectangle;!function(){Point=Class.extend({init:function(a,b){this.x=a||0,this.y=b||0},toString:function(){return JSON.stringify(this)}}),Point.sum=function(a,b){return new Point(a.x+b.x,a.y+b.y)},Size=Class.extend({init:function(a,b){this.width=a||0,this.height=b||0},toString:function(){return JSON.stringify(this)}}),Rectangle=Class.extend({init:function(a,b,c,d){this.x=a||0,this.y=b||0,this.width=c||0,this.height=d||0},toString:function(){return JSON.stringify(this)}})}();var Component,Behavior,Border,Panel,Image,View,MouseDown,MouseMove,MouseClick,MouseUp,MouseDrag;!function(){function a(){this.pressed=!1,this.dragging=!1}function b(a,b){this.location=new Point(a.clientX-b.x,a.clientY-b.y)}function c(a,b){this._action=a,this._interval=b,this._before=Date.now(),this._now=null}Component=Class.extend({init:function(){this._parent=void 0,this._coords=new Rectangle,this._mouse=new a,this._children=[],this._behaviors=[],this._visible=!0},_isPointed:function(a){var b=this.absoluteLocation(),c=b.x<=a.x&&a.x<=b.x+this._coords.width&&b.y<=a.y&&a.y<=b.y+this._coords.height;return c},_mouseEvent:function(a,b){if(this._behaviors.length>0)for(var c in this._behaviors){var d=this._behaviors[c];d instanceof a&&d.action(b)}},_mouseMove:function(a){if(this.visible()&&(this._isPointed(a.location)?(this._mouseEvent(MouseMove,a),this._mouse.pressed&&(this._mouse.dragging=!0,this._mouseEvent(MouseDrag,a))):this._mouse.dragging&&this._mouseEvent(MouseDrag,a),this._children.length>0))for(var b in this._children)this._children[b]._mouseMove(a)},_mouseDown:function(a){if(this.visible()&&(this._isPointed(a.location)&&(this._mouse.pressed=!0,this._mouseEvent(MouseDown,a)),this._children.length>0))for(var b in this._children)this._children[b]._mouseDown(a)},_mouseUp:function(a){if(this._releaseMouse(),this.visible()&&(this._isPointed(a.location)&&this._mouseEvent(MouseUp,a),this._children.length>0))for(var b in this._children)this._children[b]._mouseUp(a)},_releaseMouse:function(){if(this._mouse.pressed=!1,this._mouse.dragging=!1,this._children.length>0)for(var a in this._children)this._children[a]._releaseMouse()},_mouseClick:function(a){if(this.visible()&&(this._isPointed(a.location)&&this._mouseEvent(MouseClick,a),this._children.length>0))for(var b in this._children)this._children[b]._mouseClick(a)},toString:function(){return js.typeOf(this)},width:function(a){return js.notDefined(a)?this._coords.width:void(this._coords.width=a)},height:function(a){return js.notDefined(a)?this._coords.height:void(this._coords.height=a)},size:function(a,b){return js.empty(arguments)?new Size(this._coords.width,this._coords.height):(this.width(a),void this.height(b))},add:function(a){return assert.isType(a,[Component,Behavior]),a instanceof Component?(this._children.push(a),a._parent=this):a instanceof Behavior&&this._behaviors.push(a),a},visible:function(a){return js.notDefined(a)?this._visible:void(this._visible=a)},location:function(){switch(arguments.length){case 0:return new Point(this._coords.x,this._coords.y);case 1:var a=arguments[0];this._coords.x=a.x,this._coords.y=a.y;break;case 2:this._coords.x=arguments[0],this._coords.y=arguments[1]}},parent:function(){return this._parent},absoluteLocation:function(){return this._parent?Point.sum(this.location(),this._parent.absoluteLocation()):this.location()},_draw:function(a){var b=this.location();if(a.translate(b.x,b.y),this.draw(a),this._children.length>0)for(var c in this._children)this._children[c]._draw(a);a.translate(-b.x,-b.y)},draw:function(a){}}),Behavior=Class.extend({init:function(a){this.action=a}}),MouseDown=Behavior.extend({init:function(a){this._super(a)}}),MouseMove=Behavior.extend({init:function(a){this._super(a)}}),MouseUp=Behavior.extend({init:function(a){this._super(a)}}),MouseDrag=Behavior.extend({init:function(a){this._super(a)}}),MouseClick=Behavior.extend({init:function(a){this._super(a)}}),Border=Component.extend({init:function(){this._super(),this._color="transparent",this._borderColor="magenta",this._borderWidth=1},color:function(a){return js.not(a)?this._color:void(this._color=a)},borderColor:function(a){return js.not(a)?this._borderColor:void(this._borderColor=a)},borderWidth:function(a){return js.not(a)?this._borderWidth:void(this._borderWidth=a)},draw:function(a){a.beginPath(),a.rect(0,0,this.width(),this.height()),a.fillStyle=this.color(),a.fill(),a.lineWidth=this.borderWidth(),a.strokeStyle=this.borderColor(),a.stroke()}}),Panel=Border.extend({init:function(){this._super(),this.color("cyan")}}),Image=Component.extend({init:function(a){this._super(),this._img=a},draw:function(a){a.drawImage(this._img,0,0)}}),c.prototype={react:function(a){this._now=Date.now(),this._now-this._before>this._interval&&(this._action(a),this._before=this._now)}},View=Panel.extend({init:function(a){this._super();var d=this;this.width(a.width),this.height(a.height),this._ctx=a.getContext("2d");var e=new c(function(c){d._mouseMove(new b(c,elem.absoluteLocation(a))),d.refresh()},-1);window.addEventListener("mousemove",function(a){e.react(a)});var f=new c(function(c){d._mouseDown(new b(c,elem.absoluteLocation(a))),d.refresh()},-1);window.addEventListener("mousedown",function(a){f.react(a)});var g=new c(function(c){d._mouseUp(new b(c,elem.absoluteLocation(a))),d.refresh()},-1);window.addEventListener("mouseup",function(a){g.react(a)});var h=new c(function(c){d._mouseClick(new b(c,elem.absoluteLocation(a))),d.refresh()},-1);window.addEventListener("click",function(a){h.react(a)}),setTimeout(function(){d.refresh()},100)},refresh:function(){if(js.empty(arguments)){var a=this;window.requestAnimFrame(function(){a._ctx.clearRect(0,0,a.width(),a.height()),a._draw(a._ctx)})}}})}(),Wings={run:js.run,Class:Class,Point:Point,Size:Size,Rectangle:Rectangle,Component:Component,Behavior:Behavior,Border:Border,Panel:Panel,Image:Image,View:View,MouseDown:MouseDown,MouseMove:MouseMove,MouseClick:MouseClick,MouseUp:MouseUp,MouseDrag:MouseDrag}}();